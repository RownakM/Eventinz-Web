{% load static %}
{% load lang_tran %}
<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    {% include 'vendor_dashboard_v2/head.html' %}
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs5/jszip-2.5.0/dt-1.12.1/b-2.2.3/b-colvis-2.2.3/b-html5-2.2.3/b-print-2.2.3/r-2.3.0/datatables.min.css"/>


    <title>Dashboard Chat</title>
</head>

<body class="vendor_admin">
    {% include 'vendor_dashboard_v2/top_header.html' %}


    <div class="main-dash">
        {% include 'vendor_dashboard_v2/aside.html' %}

        <div class="dashboard flex-grow-1">

            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Quote Requests</li>
                </ol>
            </nav>
            {% if bank_noti %}
            <div class="row">
                <div class="col-lg-12">
                    <div class="alert alert-danger rounded-0" role="alert">
                        {{"You Have Not Added Your Bank Details"|transl:is_french}} ! <a href="{%url 'my_bank' %}" class="alert-link"> {{"Add Now"|transl:is_french}} ! </a>
                      </div>
                      
                </div>
            </div>
            {% endif %}

            <div class="row">
                <div class="col-12">
                    <div class="request_quote shadow-sm ">
                        <h2 class="heading">
                            {{"Transaction Details"|transl:is_french}}
                        </h2>
                     
                        {% if bank_noti %}
                        <div class="row">
                          <div class="col-lg-12">
                              <div class="alert alert-danger rounded-0" role="alert">
                                  {{"You Have Not Added Your Bank Details"|transl:is_french}} ! <a href="{%url 'my_bank' %}" class="alert-link"> {{"Add Now !"|transl:is_french}} </a> {{"To View Your Transactions"|transl:is_french}}
                                </div>
                                
                          </div>
                      </div>
                        {% else %}
                        <div class="table_row my-4">
                          <div class="table-responsive-xxl">
                              <table class="table table-borderless" id="quotetable">
                                  <thead>
                                      <tr>
                                          <th scope="col">{{"Host Name"|transl:is_french}} </th>
                                          <th scope="col">{{"Bank Name"|transl:is_french}} </th>
                                          <th scope="col">{{"Account Name"|transl:is_french}} </th>
                                          <th scope="col">{{"Bank Account Number"|transl:is_french}} </th>
                                          <th scope="col">{{"Amount"|transl:is_french}}</th>
                                          <th scope="col">{{"Transaction Date"|transl:is_french}}</th>
                                          <th scope="col">{{"Transaction File"|transl:is_french}}</th>

                                          <th scope="col">{{"Status"|transl:is_french}}</th>

                                          
                                      </tr>
                                  </thead>
                                  {% for i in records %}
                                      <tr>
                                          <td>
                                              {{i.host_id.fname}}
                                              {{i.host_id.lname}} 
                                          </td>
                                          <td>{{i.Bank_Name}} </td>
                                          <td>{{i.Account_Name}}</td>
                                          <td>
                                              
                                                  {{i.Bank_AC_Number}}
                                              
                                          </td>
                                          <td>{{i.Amount}}</td>
                                          <td>{{i.created_at|date:"d m Y"}}</td>
                                          <td><a href="{{BASE_URL}}/media/{{i.Transaction_File_Record}}" target="_blank">{{"View"|transl:is_french}}</a></td>
                                          <td>{{i.status|transl:is_french}}
                                            {% if i.status != 'Paid' and i.status != 'Rejected' %}
                                              <div class="row">
                                                  <div class="col-lg-12">
                                                      <button class="icon_btn border-1 p-2 me-1" onclick="window.location.href='{%url 'accept_trans1' %}{{i.id}}'">
                                                          {% comment %} <img src="https://img.icons8.com/fluency-systems-filled/14/000000/checked.png"/> {% endcomment %}
                                                          {% comment %} <img src="https://img.icons8.com/external-tanah-basah-detailed-outline-tanah-basah/48/000000/external-check-user-interface-tanah-basah-detailed-outline-tanah-basah-2.png"/> {% endcomment %}
                                                          {% comment %} <img src="https://img.icons8.com/external-tanah-basah-detailed-outline-tanah-basah/14/000000/external-check-user-interface-tanah-basah-detailed-outline-tanah-basah-2.png" alt="" data-bs-toggle="tooltip" data-bs-placement="top" title="View"> {% endcomment %}
                                                          {{"Accept"|transl:is_french}}
                                                      </button>
                                                      <button class="icon_btn border-1 p-2 me-1" onclick="window.location.href='{%url 'reject_trans1' %}{{i.id}}'">
                                                          {% comment %} <img src="{%static 'vendor_dashboard_v2/img/close.png' %}" alt="" data-bs-toggle="tooltip" data-bs-placement="top" title="Close"> {% endcomment %}
                                                          {{"Reject"|transl:is_french}}
                                                      </button>
                                                  </div>
                                                  
                                              </div>
                                            {% endif %}

                                          </td>

                                         

                                      </tr>
                                  {% endfor %}

                              </table>
                          </div>
                      </div>
                        {% endif %}
                        

                        


                    </div>
                </div>
            </div>

        </div>


    </div>


    <div class="footer_sec p-0">
        <div class="copyrights m-0 text-center">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <p>Â© {{"2022 Eventinz, Inc All Rights Reserved"|transl:is_french}}</p>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
    crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs5/jszip-2.5.0/dt-1.12.1/b-2.2.3/b-colvis-2.2.3/b-html5-2.2.3/b-print-2.2.3/r-2.3.0/datatables.min.js"></script>

        <script>
            function request(id,amount,type,total){
              //alert(id);
              if (type=='amt'){
                var rem_amt=total-amount;
                //alert(rem_amt);
                swal({
                  title: "Are you sure?",
                  text: "Do You Want to Request Remaining Amount ? ( "+rem_amt+" )",
                  icon: "warning",
                  buttons: true,
                  dangerMode: true,
                })
                .then((willDelete) => {
                  if (willDelete) {
                    
                    $.ajax({
                      url: "{%url 'request_rem_amt' %}?id="+id, 
                      success: function(result){
                        if(result=='OK'){
                          //window.location.href ="{%url 'vendor_billing' %}";
                          console.log("OK")
                          location.reload();
                        }
                        else{
                          swal(result);
                        }
                
                      //$("#div1").html(result);
                        //$('#askquote').html("Done");
                      //$('#askquote').focusout();
                        //alert(result);
                    }
                  });
                    
                  } else {
                    swal("Cancelled !");
                  }
                });
              }
            }
          
            function request1234(id,amount,type,total){
              //alert(id);
              if (type=='amt'){
                var rem_amt=total-amount;
                console.log(rem_amt);
                //alert(rem_amt);
                swal({
                  title: "Are you sure?",
                  text: "Do You Want to Request Remaining Amount ? ( "+rem_amt+" )",
                  icon: "warning",
                  buttons: true,
                  dangerMode: true,
                })
                .then((willDelete) => {
                  if (willDelete) {
                    
                    $.ajax({
                      url: "{%url 'request_rem_amt' %}?id="+id, 
                      success: function(result){
                        if(result=='OK'){
                          //window.location.href ="{%url 'vendor_billing' %}";
                          console.log("OK")
                          location.reload();
                        }
                        else{
                          swal(result);
                        }
                
                      //$("#div1").html(result);
                        //$('#askquote').html("Done");
                      //$('#askquote').focusout();
                        //alert(result);
                    }
                  });
                    
                  } else {
                    swal("Cancelled !");
                  }
                });
              }else if (type == 'percent'){
                var rem_amt=total-amount;
                console.log(rem_amt);
                //alert(rem_amt);
                swal({
                  title: "Are you sure?",
                  text: "Do You Want to Request Remaining Amount ? ( "+rem_amt+" )",
                  icon: "warning",
                  buttons: true,
                  dangerMode: true,
                })
                .then((willDelete) => {
                  if (willDelete) {
                    
                    $.ajax({
                      url: "{%url 'request_rem_amt' %}?id="+id, 
                      success: function(result){
                        if(result=='OK'){
                          //window.location.href ="{%url 'vendor_billing' %}";
                          console.log("OK")
                          location.reload();
                        }
                        else{
                          swal(result);
                        }
                
                      //$("#div1").html(result);
                        //$('#askquote').html("Done");
                      //$('#askquote').focusout();
                        //alert(result);
                    }
                  });
                    
                  } else {
                    swal("Cancelled !");
                  }
                });
              }
            }
          </script>
          <script>
            $(document).ready( function () {
              $('#quotetable').DataTable({
                responsive: true,
                //paging: false,
                pagingType: 'simple_numbers',
                ordering:  true,
                
          
              });
            } );
          </script>
          <script>
            function getcontent(id)
            {
                console.log("OK");
                id=id;
                $.ajax({
                    url: "{%url 'get_content' %}",
                    data: "id=" + id,
                    success: function(msg){
                      console.log(msg);
                      swal(msg);
          
                              }
                });
            }
          </script>
          <script>
              $('#sbtn').on('click',function(){
                  $(this).prop('disabled',true);
                  $(this).html(`
                  <div class="spinner-border spinner-border-sm text-light" role="status">
                      <span class="visually-hidden">Loading...</span>
                    </div> Please Wait...
                  `);
                  $('#pupdate').submit()
              })
          </script>
          <script>
              tinymce.init({
                selector: 'textarea',
                plugins: 'advlist autolink lists link image charmap preview anchor pagebreak',
                toolbar_mode: 'floating',
                menubar:false,
                statusbar:false
              });
            </script>
          <script>
            $( document ).ready(function() {
              console.log("OK");
              
              
            });
          </script>
          
          <script>
            function engage(id){
              
              var type='accept';
              $.ajax({
                url: "{%url 'change_quote_state' %}"+"?type="+type+"&id="+id, 
                success: function(result){
                  if(result=='ok'){
                    window.location.href ="{%url 'vendor_billing' %}";
          
                  }
                  else{
                    swal(result);
                  }
          
                //$("#div1").html(result);
                  //$('#askquote').html("Done");
                //$('#askquote').focusout();
                  //alert(result);
              }
            })
              // alert("Accept : " + id);
            }
            function reject(id){
              var type='reject';
              $.ajax({
                url: "{%url 'change_quote_state' %}"+"?type="+type+"&id="+id, 
                success: function(result){
                //$("#div1").html(result);
                 // $('#askquote').html("Done");
                //$('#askquote').focusout();
                 // alert(result);
                 location.reload();
              }
            });
             // alert("Reject : " + id);
            }
          </script>


</body>

</html>