{% load static %}
{% load cool_num %}
{% load get_event_type %}
{% load lang_tran %}
<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    {% include 'vendor_dashboard_v2/head.html' %}

    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs5/jszip-2.5.0/dt-1.12.1/b-2.2.3/b-colvis-2.2.3/b-html5-2.2.3/b-print-2.2.3/r-2.3.0/datatables.min.css"/>


    <title>Dashboard - Eventinz </title>
</head>

<body class="vendor_admin">
    {% include 'vendor_dashboard_v2/top_header.html' %}


    <div class="main-dash">
        {% include 'vendor_dashboard_v2/aside.html' %}

        <div class="dashboard w-100">

            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">{{"Home"|transl:is_french}}</a></li>
                    <li class="breadcrumb-item active" aria-current="page">{{"Dashboard"|transl:is_french}}</li>
                </ol>
            </nav>
            {% if bank_noti %}
            <div class="row">
                <div class="col-lg-12">
                    <div class="alert alert-danger rounded-0" role="alert">
                        {{"You Have Not Added Your Bank Details !"|transl:is_french}} <a href="{%url 'my_bank' %}" class="alert-link"> {{"Add Now !"|transl:is_french}} </a>
                      </div>
                      
                </div>
            </div>
            {% endif %}
            {% with get_ev_leads.remaining_balance|floatformat as balance %}
            {% if balance|get_int %}
            <div class="row">
                <div class="col-lg-12">
                    <div class="alert alert-info rounded-0" role="alert">
                        {{"Your Leads is Low !!"|transl:is_french}}  <a href="{%url 'renew_leads' %}" class="alert-link"> {{"Buy Leads !"|transl:is_french}} </a>
                      </div>
                      
                </div>
            </div>
            {% endif %}
            {% endwith %}
            <div class="vendor_card">
                <div class="row">
                    <div class="col-lg-3 col-md-6 ">
                        <div class=" shadow-sm box ">
                            <img src="{%static 'vendor_dashboard_v2/img/earning.png' %}" alt="" class="img-fluid">
                            <h2>{{"Event Payment Pending Approval"|transl:is_french}}</h2>
                            <h3>{{pending_approval}}</h3>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 ">
                        <div class=" shadow-sm box pink_box">
                            <img src="{%static 'vendor_dashboard_v2/img/eventinz.png' %}" alt="" class="img-fluid">
                            <h2>{{"Eventinz Leads"|transl:is_french}} 
                                
                                <button class="crt_pack_btn" style="padding: 8px; width: auto;float: right;" onclick="window.location.href='{%url 'renew_leads' %}';">{{"Buy Leads"|transl:is_french}}</button> 
                                {% comment %} {% endif %}
                                {% endwith %} {% endcomment %}
                            </h2>
                            <h3>{{get_ev_leads.remaining_balance}}/{{get_ev_leads.total_balance}}</h3>
                            

                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 ">
                        <div class=" shadow-sm box green_box ">
                            <img src="{%static 'vendor_dashboard_v2/img/order.png' %}" alt="" class="img-fluid">
                            <h2>{{"Accepted Orders"|transl:is_french}}</h2>
                            <h3>{{total_accepted_orders_count}}</h3>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 ">
                        <div class=" shadow-sm box yello_box">
                            <img src="{%static 'vendor_dashboard_v2/img/sales.png' %}" alt="" class="img-fluid">
                            <h2>{{"Quote Pending Payment Approval"|transl:is_french}}</h2>
                            <h3>{{pending_approval_quote}}</h3>
                        </div>
                    </div>
                </div>
            </div>

            <div class="second_row my-4">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="box shadow-sm">
                            <h3 class="mb-4">{{"Sales Overview"|transl:is_french}}</h3>
                            <!-- <img src="./img/chart.png" alt="" class="img-fluid chart_img mt-4"> -->
                            <canvas id="myLineChart" style="max-width:100%"></canvas>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="box shadow-sm">
                            <h3>{{"Eventinz HotSpots"|transl:is_french}}</h3>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="info_box box_1">
                                        <div class="d-flex align-items-center">
                                            <figure class="m-0">
                                                <img src="{%static 'vendor_dashboard_v2/img/events.png' %}" alt="" class="img-fluid">
                                            </figure>
                                            <div class="info">
                                                <h3>{{"Events"|transl:is_french}}</h3>
                                                <h4>{{total_event_count|cool_number}}</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="info_box box_2">
                                        <div class="d-flex align-items-center">
                                            <figure class="m-0">
                                                <img src="{%static 'vendor_dashboard_v2/img/clicks.png' %}" alt="" class="img-fluid">
                                            </figure>
                                            <div class="info">
                                                <h3>{{"Clicks"|transl:is_french}}</h3>
                                                <h4>{{get_clicks|cool_number}}</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="info_box box_3">
                                        <div class="d-flex align-items-center">
                                            <figure class="m-0">
                                                <img src="{%static 'vendor_dashboard_v2/img/packages.png' %}" alt="" class="img-fluid">
                                            </figure>
                                            <div class="info">
                                                <h3>{{"packages"|transl:is_french|title}} </h3>
                                                <h4>{{vendor_pack|cool_number}}</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="info_box box_4">
                                        <div class="d-flex align-items-center">
                                            <figure class="m-0">
                                                <img src="{%static 'vendor_dashboard_v2/img/request.png' %}" alt="" class="img-fluid">
                                            </figure>
                                            <div class="info">
                                                <h3>{{"Quote Request"|transl:is_french}}</h3>
                                                <h4>{{quote_req|cool_number}}</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
<!--
            <div class="table_row my-4">
                <div class="row">
                    <div class="col-12">
                        <div class="table_box shadow-sm">
                            <h5 class="table_heading">
                                Active Events (<span id="total_count">0</span>) <span style"float: right;"><button class="readmorebtn" id="loadmorebtn" onclick="event_load_new();">Reload Events</span> 
                                {% comment %} <span style="float: right;"><img src="https://i.ibb.co/h8s2hmv/icons8-online.gif" class="img-fluid w-4" alt=""> Updating Live</span> {% endcomment %}
                            </h5>
                            <div class="table-responsive">


                                <table class="table table-borderless" id="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Post ID</th>

                                            <th scope="col">Posted On</th>
                                            <th scope="col">Event Type </th>
                                            <th scope="col">Host Name </th>
                                            <th scope="col">Description </th>
                                            <th scope="col">More </th>
                                        </tr>
                                    </thead>
                                    <tbody id="live_data_events">
                                        {% for i in ev %}
                                        <tr class="
                                        {%if i.id|is_bid:get_id %} 
                                        bg-success text-white
                                        {% endif %}">
                                            <td>{{i.id}}</td>
                                            <td>{{i.created_on|date:"d-M-Y"}}</td>
                                            <td>{{i.ev_name}}</td>
                                            <td>{{i.First_Name}} {{i.Last_Name}}</td>
                                            <td><div class="overflow-auto" style="max-height: 100px;">{{i.Event_Desc}}</div></td>
                                            <td class="text-center ps-0">
                                                {%if not i.id|is_bid:get_id %} 
                                       
                                                <button class="px-2
                                                {%if i.id|is_bid:get_id %} 
                                        text-white
                                        {% endif %}
                                                " onclick="window.location.href='{%url 'event_live' %}{{i.id}}'">view</button>
                                                {% else %}
                                                <button class="
                                                {%if i.id|is_bid:get_id %} 
                                        text-white
                                        {% endif %}px-2" onclick="window.location.href='{%url 'event_live' %}{{i.id}}'">Quote Sent</button>
                                                {% endif %}
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            -->

            <div class="two_card">
                <div class="row mt-4 mb-5">
                    <div class="col-lg-6">
                        <div class="evn_card">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="evntcardcont">
                                        <h2>{{"Eventinz"|transl:is_french}} <br> {{"Your Event Your Way"|transl:is_french}}</h2>
                                        <p class="stupdt">{{"Stay Up To Date"|transl:is_french}}</p>
                                        <p class="faceprb">{{"Facing Problems ? Go through"}} <br> {{"our FAQs or connect to our support."|transl:is_french}}</p>
                                        <button class="readmorebtn">{{"Read More"|transl:is_french}}</button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="evcardimg"><img src="{%static 'vendor_dashboard_v2/img/card1.png' %}" alt=""></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="evn_card">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="evntcardcont">
                                        <h2>{{"Get A Step"|transl:is_french}} <br> {{"Ahead with Eventinz"|transl:is_french}}</h2>
                                        <p class="stupdt">{{"Get Your Brand A Name , A Recognition !"|transl:is_french}} <br>
                                            {{"Get The Best In-Class recommendations"|transl:is_french}} <br>
                                            {{"from or experts !"|transl:is_french}}</p>
                                        <button class="readmorebtn">{{"Read More"|transl:is_french}}</button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="evcardimg"><img src="{%static 'vendor_dashboard_v2/img/card2.png' %}" alt=""></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>


    </div>


    <div class="footer_sec p-0">
        <div class="copyrights m-0 text-center">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <p>© {{"2022 Eventinz, Inc All Rights Reserved"|transl:is_french}}</p>
                    </div>
                </div>
            </div>
        </div>

    </div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
    crossorigin="anonymous"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script type="text/javascript" src="https://cdn.datatables.net/v/bs5/jszip-2.5.0/dt-1.12.1/b-2.2.3/b-colvis-2.2.3/b-html5-2.2.3/b-print-2.2.3/r-2.3.0/datatables.min.js"></script>

<script>
    function event_load(){
        $('#loadmorebtn').html(`
        <div class="spinner-border spinner-border-sm" role="status">
            <span class="visually-hidden">Loading...</span>
            </div>&nbsp; &nbsp;Refreshing...
        `);
        var settings = {
            "url":"{%url 'get_live_events' %}",
            "method":"GET",
        };
        $.ajax(settings).done(function(response){
            var data = response;
            console.log(response);
            $('#live_data_events').html('');
            $('#total_count').html(response.length);
            //console.log(response.length);
            for (var i = 0; i < response.length; i++) {
                // POPULATE SELECT ELEMENT WITH JSON.
                ele=document.getElementById('live_data_events');
                var desc = data[i].fields.Event_Desc;
                var trimmedString = desc.substr(0, 50);
                trimmedString = trimmedString.substr(0, Math.min(trimmedString.length, trimmedString.lastIndexOf(" ")));
                var vendor_type=data[i].fields.vendor_type;
                //console.log(vendor_type);
                var vendor_type_list=vendor_type.split(",");
                //console.log(vendor_type_list);
                let z = 0;
                const vendor_type_list_filtered=[];
                //console.log("OKK");
                //while(z < vendor_type_list.length){
                //    axios.get("{%url 'get_vendor_categories' %}?id="+vendor_type_list[z])
                //      .then(function (a) {
                //        console.log(a);
                //        vendor_type_list_filtered.push(a);
    
                //      })
                //      .catch(function (error) {
                //        console.log(error);
                //      });
                //}
                //console.log(vendor_type_list_filtered);
                var date = data[i].fields.created_on
                var date_new = date.slice(0,10)
                ele.innerHTML = ele.innerHTML +
                    `<tr>
                        <td>${data[i].pk}</td>
                        <td>${date_new}</td>
                        <td>${data[i].fields.ev_name}</td>
                        <td>${data[i].fields.First_Name} ${data[i].fields.Last_Name}</td>
                        <td><div class="overflow-auto" style="max-height: 100px;">${desc}</div></td>
                        <td class="text-center ps-0"><button class="px-2" onclick="window.location.href='{%url 'event_live' %}${data[i].pk}'">view</button></td>
                    </tr>`;
                
            }
            var table=$('#table').DataTable().destroy();
            var table = $('#table').DataTable({
                responsive: true,
                paging: true,
                pageLength : 5,
                pagingType: 'simple_numbers',
                ordering: true,
                order: [[1, 'desc']],
            });
            $('#loadmorebtn').html(`
        Reload Events
        `);
        });
    }
    function event_load_new(){
        $('#loadmorebtn').html(`
        <div class="spinner-border spinner-border-sm" role="status">
            <span class="visually-hidden">Loading...</span>
            </div>&nbsp; &nbsp;Refreshing...
        `);
        location.reload();
    }
    $(document).ready(function(){
    var event_category_name='';
    data = '';
    //$('#live_data_events').html();
    var table = $('#table').DataTable({
        responsive: true,
        paging: true,
        pageLength : 5,
        pagingType: 'simple_numbers',
        ordering: true,
        order: [[1, 'desc']],
    });
    //event_load();
    });

    
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script>
        var xValues = ["Mar", "Apr", "May", "Jun", "Jul", "Aug"];
        var yValues = [30, 80, 0, 75, 0, 0];

        new Chart("myLineChart", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                    fill: false,
                    lineTension: 0,
                    backgroundColor: "#9f007e",
                    borderColor: "#9f007e",
                    data: yValues,
                    lineTension: 0,
                }]
            },
            options: {
                bezierCurve: false,
                legend: { display: false },
                scales: {
                    yAxes: [{ ticks: { min: 0, max: 100 } }],
                },
                elements: {
                    line: {
                        borderJoinStyle: 'round',
                        tension: 0
                    }
                }
            }
        });
    </script>
    <script>
        let ctx = document.getElementById("myLineChart").getContext('2d');

        var gradientStroke = ctx.createLinearGradient(500, 0, 100, 0);
        gradientStroke.addColorStop(0, "#c90b9e");
        gradientStroke.addColorStop(1, "#c90b9e");

        var gradientBkgrd = ctx.createLinearGradient(0, 100, 0, 400);
        gradientBkgrd.addColorStop(0, "rgba(201, 11, 158, 0.2)");
        gradientBkgrd.addColorStop(1, "rgba(201, 11, 158, 0)");

        let draw = Chart.controllers.line.prototype.draw;
        Chart.controllers.line = Chart.controllers.line.extend({
            draw: function () {
                draw.apply(this, arguments);
                let ctx = this.chart.chart.ctx;
                let _stroke = ctx.stroke;
                ctx.stroke = function () {
                    ctx.save();
                    //ctx.shadowColor = 'rgba(244,94,132,0.8)';
                    ctx.shadowBlur = 8;
                    ctx.shadowOffsetX = 0;
                    ctx.shadowOffsetY = 6;
                    _stroke.apply(this, arguments)
                    ctx.restore();
                }
            }
        });




        var chart = new Chart(ctx, {
            // The type of chart we want to create
            type: 'line',

            // The data for our dataset
            data: {
                labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                datasets: [{
                    label: "Income",
                    backgroundColor: gradientBkgrd,
                    borderColor: gradientStroke,
                    data: [
           
							{{monthly_data.Jan_sales}},
							{{monthly_data.Feb_sales}},
							{{monthly_data.Mar_sales}},
							{{monthly_data.Apr_sales}},
							{{monthly_data.May_sales}},
							{{monthly_data.Jun_sales}},
							{{monthly_data.Jul_sales}},
							{{monthly_data.Aug_sales}},
							{{monthly_data.Sep_sales}},
							{{monthly_data.Oct_sales}},
							{{monthly_data.Nov_sales}},
							{{monthly_data.Dec_sales}},










						 
              ],

                    pointBorderColor: "#c90b9e",
                    pointBackgroundColor: "#c90b9e",
                    pointBorderWidth: 0,
                    pointHoverRadius: 8,
                    // pointHoverBackgroundColor: gradientStroke,
                    pointHoverBorderColor: "rgba(220,220,220,1)",
                    pointHoverBorderWidth: 4,
                    pointRadius: 1,
                    borderWidth: 5,
                    pointHitRadius: 16,
                }]
            },

            // Configuration options go here
            options: {
                tooltips: {
                    backgroundColor: '#fff',
                    displayColors: false,
                    titleFontColor: '#000',
                    bodyFontColor: '#000'

                },
                legend: {
                    display: false
                },
                scales: {
                    xAxes: [{
                        gridLines: {
                            display: false
                        }
                    }],
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            
                            // Include a dollar sign in the ticks
                            callback: function (value, index, values) {
                                return (value);
                            }
                        }
                    }],
                }
            }
        });
    </script>


</body>

</html>